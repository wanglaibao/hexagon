



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="The atoms of your platform">
      
      
        <link rel="canonical" href="https://hexagonkt.com/quick_start/">
      
      
        <meta name="author" content="Juanjo Aguililla">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.1.2">
    
    
      
        <title>Quick Start - Hexagon</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.3020aac5.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#546691">
      
    
    
      <script src="../assets/javascripts/modernizr.01ccdecf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Titillium Web","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../css/mkdocs_palette.css">
    
      <link rel="stylesheet" href="../css/mkdocs.css">
    
    
      
        
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-48216810-3", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    



<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<meta name="keywords" content="Hexagon, microservices, Kotlin, RabbitMQ, MongoDB, JVM, Web" />
<meta name="application-name" content="Hexagon" />

<meta name="msapplication-navbutton-color" content="#546691" />
<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#546691">
<meta name="msapplication-TileImage" content="/apple-touch-icon.png">

<meta name="apple-mobile-web-app-status-bar-style" content="#546691" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="mobile-web-app-capable" content="yes" />

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
<link rel="icon" sizes="16x16 32x32 64x64" href="/favicon.ico">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@hexagon_kt">
<meta name="twitter:creator" content="@hexagon_kt">
<meta name="twitter:title" content="Hexagon">
<meta name="twitter:description" content="Hexagon is a microservices toolkit written in Kotlin. Its purpose is to ease the building of services (Web applications, APIs or queue consumers) that run inside a cloud platform
">
<meta name="twitter:image" content="https://hexagonkt.comapple-touch-icon.png">

<meta property="og:title" content="Hexagon" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hexagonkt.com" />
<meta property="og:image" content="https://hexagonkt.comapple-touch-icon.png" />
<meta property="og:description" content="Hexagon is a microservices toolkit written in Kotlin. Its purpose is to ease the building of services (Web applications, APIs or queue consumers) that run inside a cloud platform
" />

<meta itemprop="name" content="Hexagon">
<meta itemprop="description" content="Hexagon is a microservices toolkit written in Kotlin. Its purpose is to ease the building of services (Web applications, APIs or queue consumers) that run inside a cloud platform
 ">
<meta itemprop="image" content="https://hexagonkt.comapple-touch-icon.png">

<link rel="author" href="/humans.txt" />
<link rel="manifest" href="/manifest.json">

<!-- Web worker -->
<!--
<script>
if ('serviceWorker' in navigator)
  navigator.serviceWorker
    .register('/service_worker.js')
    .then(function() { console.log('Worker Registered'); });
</script>
-->

  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#what-is-hexagon" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://hexagonkt.com" title="Hexagon" class="md-header-nav__button md-logo">
          
            <img src="../img/logo_white.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Hexagon
            </span>
            <span class="md-header-nav__topic">
              Quick Start
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/hexagonkt/hexagon/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://hexagonkt.com" title="Hexagon" class="md-nav__button md-logo">
      
        <img src="../img/logo_white.svg" width="48" height="48">
      
    </a>
    Hexagon
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/hexagonkt/hexagon/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Quick Start
      </label>
    
    <a href="./" title="Quick Start" class="md-nav__link md-nav__link--active">
      Quick Start
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-hexagon" title="What is Hexagon" class="md-nav__link">
    What is Hexagon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hexagon-structure" title="Hexagon Structure" class="md-nav__link">
    Hexagon Structure
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-http-service" title="Simple HTTP service" class="md-nav__link">
    Simple HTTP service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#books-example" title="Books Example" class="md-nav__link">
    Books Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-example" title="Session Example" class="md-nav__link">
    Session Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cookies-example" title="Cookies Example" class="md-nav__link">
    Cookies Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling-example" title="Error Handling Example" class="md-nav__link">
    Error Handling Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filters-example" title="Filters Example" class="md-nav__link">
    Filters Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#files-example" title="Files Example" class="md-nav__link">
    Files Example
  </a>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../documentation/" title="Documentation" class="md-nav__link">
      Documentation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../create_services/" title="Create Services" class="md-nav__link">
      Create Services
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../gradle/" title="Gradle Helpers" class="md-nav__link">
      Gradle Helpers
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../examples/" title="Examples" class="md-nav__link">
      Examples
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Modules
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Modules
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../hexagon_core/" title="Core" class="md-nav__link">
      Core
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../hexagon_scheduler/" title="Scheduler" class="md-nav__link">
      Scheduler
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../hexagon_web/" title="Web" class="md-nav__link">
      Web
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Ports
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Ports
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../port_http_server/" title="HTTP Server" class="md-nav__link">
      HTTP Server
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../port_http_client/" title="HTTP Client" class="md-nav__link">
      HTTP Client
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../port_store/" title="Store" class="md-nav__link">
      Store
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../port_messaging/" title="Messaging" class="md-nav__link">
      Messaging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../port_templates/" title="Templates" class="md-nav__link">
      Templates
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Contribute
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Contribute
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="https://github.com/hexagonkt/hexagon/blob/master/contributing.md" title="Contributing" class="md-nav__link">
      Contributing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://github.com/hexagonkt/hexagon/projects/1" title="Planning" class="md-nav__link">
      Planning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://github.com/hexagonkt/hexagon/milestones" title="Roadmap" class="md-nav__link">
      Roadmap
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../alternatives/" title="Alternatives" class="md-nav__link">
      Alternatives
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-hexagon" title="What is Hexagon" class="md-nav__link">
    What is Hexagon
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hexagon-structure" title="Hexagon Structure" class="md-nav__link">
    Hexagon Structure
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-http-service" title="Simple HTTP service" class="md-nav__link">
    Simple HTTP service
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#books-example" title="Books Example" class="md-nav__link">
    Books Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-example" title="Session Example" class="md-nav__link">
    Session Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cookies-example" title="Cookies Example" class="md-nav__link">
    Cookies Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling-example" title="Error Handling Example" class="md-nav__link">
    Error Handling Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#filters-example" title="Filters Example" class="md-nav__link">
    Filters Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#files-example" title="Files Example" class="md-nav__link">
    Files Example
  </a>
  
</li>
      
      
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/hexagonkt/hexagon/edit/master/hexagon_site/pages/quick_start.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Quick Start</h1>
                
                <h2 id="what-is-hexagon">What is Hexagon<a class="headerlink" href="#what-is-hexagon" title="Permanent link">&para;</a></h2>
<p>Hexagon is a microservices toolkit (not a <a href="https://www.quora.com/Whats-the-difference-between-a-library-and-a-framework">framework</a>) written in <a href="http://kotlinlang.org">Kotlin</a>. Its purpose is to ease
the building of services (Web applications, APIs or queue consumers) that run inside a cloud
platform.</p>
<p>It is meant to provide abstraction from underlying technologies (data storage, HTTP server engines,
etc.) to be able to change them with minimum impact. It is designed to fit in applications that
conforms to the <a href="http://fideloper.com/hexagonal-architecture">Hexagonal Architecture</a> (also called <a href="https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html">Clean Architecture</a> or
<a href="https://herbertograca.com/2017/09/14/ports-adapters-architecture">Ports and Adapters Architecture</a>).</p>
<p>The goals of the project are:</p>
<ol>
<li>Be simple to use: make it easy to develop user services (HTTP or message consumers) quickly. It
   is focused on making the usual tasks easy, rather than making a complex tool with a lot of
   features.</li>
<li>Make it easy to hack: allow the user to add extensions or change the toolkit itself. The code is
   meant to be simple for the users to understand it. Avoid having to read blogs, documentation or
   getting certified to use it effectively.</li>
</ol>
<p>Which are NOT project goals:</p>
<ol>
<li>To be the fastest framework. Write the code fast and optimize only the critical parts. It is
   <a href="https://www.techempower.com/benchmarks">not slow</a> anyway.</li>
<li>Support all available technologies and tools: the spirit is to define simple interfaces for
   the most common features , so users can implement integrations with different tools easily.</li>
<li>To be usable from Java. Hexagon is <em>Kotlin first</em>.</li>
</ol>
<h2 id="hexagon-structure">Hexagon Structure<a class="headerlink" href="#hexagon-structure" title="Permanent link">&para;</a></h2>
<p>There are three kind of client libraries:</p>
<ul>
<li>The ones that provide a single functionality that does not depend on different implementations.</li>
<li>Modules that define a "Port": An interface to a feature that may have different implementations.</li>
<li>Adapter modules, which are Port implementations for a given tool.</li>
</ul>
<p>Ports are independent from each other.</p>
<p>Hexagon Core module provides convenience utilities. The main features it has are:</p>
<ul>
<li><a href="/hexagon_core/com.hexagonkt.helpers">Helpers</a>: JVM information, a logger and other useful utilities.</li>
<li><a href="/hexagon_core/com.hexagonkt.injection">Dependency Injection</a>: bind classes to creation closures or instances and inject them.</li>
<li><a href="/hexagon_core/com.hexagonkt.serialization">Instance Serialization</a>: parse/serialize data in different formats to class instances.</li>
<li><a href="/hexagon_core/com.hexagonkt.settings">Configuration Settings</a>: load settings from different data sources and formats.</li>
</ul>
<h2 id="simple-http-service">Simple HTTP service<a class="headerlink" href="#simple-http-service" title="Permanent link">&para;</a></h2>
<p>You can clone a starter project (<a href="https://github.com/hexagonkt/gradle_starter">Gradle Starter</a> or <a href="https://github.com/hexagonkt/maven_starter">Maven Starter</a>). Or you can create a project
from scratch following these steps:</p>
<ol>
<li>Configure <a href="http://kotlinlang.org">Kotlin</a> in <a href="https://kotlinlang.org/docs/reference/using-gradle.html">Gradle</a> or <a href="https://kotlinlang.org/docs/reference/using-maven.html">Maven</a>.</li>
<li>Setup the <a href="https://bintray.com/bintray/jcenter">JCenter</a> repository (follow the link and click on the <code class="codehilite">Set me up!</code> button).</li>
<li>
<p>Add the dependency:</p>
</li>
<li>
<p>In Gradle. Import it inside <code class="codehilite">build.gradle</code>:</p>
<div class="codehilite"><pre><span></span><span class="n">compile</span> <span class="o">(</span><span class="s2">&quot;com.hexagonkt:http_server_jetty:$hexagonVersion&quot;</span><span class="o">)</span>
</pre></div>

</li>
<li>
<p>In Maven. Declare the dependency in <code class="codehilite">pom.xml</code>:</p>
<div class="codehilite"><pre><span></span><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>com.hexagonkt<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>http_server_jetty<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>$hexagonVersion<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>

</li>
<li>
<p>Write the code in the <code class="codehilite">src/main/kotlin/Hello.kt</code> file:</p>
</li>
</ol>
<div class="codehilite"><pre><span></span><span class="k">import</span> <span class="nn">com.hexagonkt.http.httpDate</span>
<span class="k">import</span> <span class="nn">com.hexagonkt.http.server.Server</span>
<span class="k">import</span> <span class="nn">com.hexagonkt.http.server.ServerPort</span>
<span class="k">import</span> <span class="nn">com.hexagonkt.http.server.jetty.JettyServletAdapter</span>
<span class="k">import</span> <span class="nn">com.hexagonkt.injection.InjectionManager.bindObject</span>

<span class="cm">/**</span>
<span class="cm"> * Service server. It is created lazily to allow ServerPort injection (set up in main).</span>
<span class="cm"> */</span>
<span class="k">val</span> <span class="py">server</span><span class="p">:</span> <span class="n">Server</span> <span class="k">by</span> <span class="n">lazy</span> <span class="p">{</span>
    <span class="n">Server</span> <span class="p">{</span>
        <span class="n">before</span> <span class="p">{</span>
            <span class="n">response</span><span class="p">.</span><span class="n">setHeader</span><span class="p">(</span><span class="s">&quot;Date&quot;</span><span class="p">,</span> <span class="n">httpDate</span><span class="p">())</span>
        <span class="p">}</span>

        <span class="k">get</span><span class="p">(</span><span class="s">&quot;/hello/{name}&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">ok</span><span class="p">(</span><span class="s">&quot;Hello, ${pathParameters[&quot;</span><span class="n">name</span><span class="s">&quot;]}!&quot;</span><span class="p">,</span> <span class="s">&quot;text/plain&quot;</span><span class="p">)</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Start the service from the command line.</span>
<span class="cm"> */</span>
<span class="k">fun</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">bindObject</span><span class="p">&lt;</span><span class="n">ServerPort</span><span class="p">&gt;(</span><span class="n">JettyServletAdapter</span><span class="p">())</span> <span class="c1">// Bind Jetty server to HTTP Server Port</span>
    <span class="n">server</span><span class="p">.</span><span class="n">start</span><span class="p">()</span>
<span class="p">}</span>
</pre></div>

<ol>
<li>Run the service and view the results at: <a href="http://localhost:2010/hello/world">http://localhost:2010/hello/world</a></li>
</ol>
<p>You can check the <a href="/documentation.html">documentation</a> for more details. Or you can clone the <a href="https://github.com/hexagonkt/gradle_starter">Gradle Starter</a> or
<a href="https://github.com/hexagonkt/maven_starter">Maven Starter</a> for a minimal fully working example (including tests).</p>
<h2 id="books-example">Books Example<a class="headerlink" href="#books-example" title="Permanent link">&para;</a></h2>
<p>A simple CRUD example showing how to manage book resources. Here you can check the
<a href="https://github.com/hexagonkt/hexagon/blob/master/port_http_server/src/test/kotlin/com/hexagonkt/http/server/examples/BooksTest.kt">full test</a>.</p>
<div class="codehilite"><pre><span></span><span class="k">data</span> <span class="k">class</span> <span class="nc">Book</span><span class="p">(</span><span class="k">val</span> <span class="py">author</span><span class="p">:</span> <span class="n">String</span><span class="p">,</span> <span class="k">val</span> <span class="py">title</span><span class="p">:</span> <span class="n">String</span><span class="p">)</span>

<span class="k">private</span> <span class="k">val</span> <span class="py">books</span><span class="p">:</span> <span class="n">MutableMap</span><span class="p">&lt;</span><span class="n">Int</span><span class="p">,</span> <span class="n">Book</span><span class="p">&gt;</span> <span class="p">=</span> <span class="n">linkedMapOf</span><span class="p">(</span>
    <span class="m">100</span> <span class="n">to</span> <span class="n">Book</span><span class="p">(</span><span class="s">&quot;Miguel de Cervantes&quot;</span><span class="p">,</span> <span class="s">&quot;Don Quixote&quot;</span><span class="p">),</span>
    <span class="m">101</span> <span class="n">to</span> <span class="n">Book</span><span class="p">(</span><span class="s">&quot;William Shakespeare&quot;</span><span class="p">,</span> <span class="s">&quot;Hamlet&quot;</span><span class="p">),</span>
    <span class="m">102</span> <span class="n">to</span> <span class="n">Book</span><span class="p">(</span><span class="s">&quot;Homer&quot;</span><span class="p">,</span> <span class="s">&quot;The Odyssey&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="k">val</span> <span class="py">server</span><span class="p">:</span> <span class="n">Server</span> <span class="k">by</span> <span class="n">lazy</span> <span class="p">{</span>
    <span class="n">Server</span><span class="p">(</span><span class="n">adapter</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">post</span><span class="p">(</span><span class="s">&quot;/books&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Require fails if parameter does not exists</span>
            <span class="k">val</span> <span class="py">author</span> <span class="p">=</span> <span class="n">parameters</span><span class="p">.</span><span class="n">require</span><span class="p">(</span><span class="s">&quot;author&quot;</span><span class="p">).</span><span class="n">first</span><span class="p">()</span>
            <span class="k">val</span> <span class="py">title</span> <span class="p">=</span> <span class="n">parameters</span><span class="p">.</span><span class="n">require</span><span class="p">(</span><span class="s">&quot;title&quot;</span><span class="p">).</span><span class="n">first</span><span class="p">()</span>
            <span class="k">val</span> <span class="py">id</span> <span class="p">=</span> <span class="p">(</span><span class="n">books</span><span class="p">.</span><span class="n">keys</span><span class="p">.</span><span class="n">max</span><span class="p">()</span> <span class="o">?:</span> <span class="m">0</span><span class="p">)</span> <span class="p">+</span> <span class="m">1</span>
            <span class="n">books</span> <span class="p">+=</span> <span class="n">id</span> <span class="n">to</span> <span class="n">Book</span><span class="p">(</span><span class="n">author</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>
            <span class="n">send</span><span class="p">(</span><span class="m">201</span><span class="p">,</span> <span class="n">id</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="k">get</span><span class="p">(</span><span class="s">&quot;/books/{id}&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Path parameters *must* exist an error is thrown if they are not present</span>
            <span class="k">val</span> <span class="py">bookId</span> <span class="p">=</span> <span class="n">pathParameters</span><span class="p">[</span><span class="s">&quot;id&quot;</span><span class="p">].</span><span class="n">toInt</span><span class="p">()</span>
            <span class="k">val</span> <span class="py">book</span> <span class="p">=</span> <span class="n">books</span><span class="p">[</span><span class="n">bookId</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">book</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                <span class="c1">// ok() is a shortcut to send(200)</span>
                <span class="n">ok</span><span class="p">(</span><span class="s">&quot;Title: ${book.title}, Author: ${book.author}&quot;</span><span class="p">)</span>
            <span class="k">else</span>
                <span class="n">send</span><span class="p">(</span><span class="m">404</span><span class="p">,</span> <span class="s">&quot;Book not found&quot;</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="n">put</span><span class="p">(</span><span class="s">&quot;/books/{id}&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">val</span> <span class="py">bookId</span> <span class="p">=</span> <span class="n">pathParameters</span><span class="p">[</span><span class="s">&quot;id&quot;</span><span class="p">].</span><span class="n">toInt</span><span class="p">()</span>
            <span class="k">val</span> <span class="py">book</span> <span class="p">=</span> <span class="n">books</span><span class="p">[</span><span class="n">bookId</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">book</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">books</span> <span class="p">+=</span> <span class="n">bookId</span> <span class="n">to</span> <span class="n">book</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span>
                    <span class="n">author</span> <span class="p">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s">&quot;author&quot;</span><span class="p">]</span><span class="o">?.</span><span class="n">first</span><span class="p">()</span> <span class="o">?:</span> <span class="n">book</span><span class="p">.</span><span class="n">author</span><span class="p">,</span>
                    <span class="n">title</span> <span class="p">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s">&quot;title&quot;</span><span class="p">]</span><span class="o">?.</span><span class="n">first</span><span class="p">()</span> <span class="o">?:</span> <span class="n">book</span><span class="p">.</span><span class="n">title</span>
                <span class="p">)</span>

                <span class="n">ok</span><span class="p">(</span><span class="s">&quot;Book with id &#39;$bookId&#39; updated&quot;</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="n">send</span><span class="p">(</span><span class="m">404</span><span class="p">,</span> <span class="s">&quot;Book not found&quot;</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="n">delete</span><span class="p">(</span><span class="s">&quot;/books/{id}&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">val</span> <span class="py">bookId</span> <span class="p">=</span> <span class="n">pathParameters</span><span class="p">[</span><span class="s">&quot;id&quot;</span><span class="p">].</span><span class="n">toInt</span><span class="p">()</span>
            <span class="k">val</span> <span class="py">book</span> <span class="p">=</span> <span class="n">books</span><span class="p">[</span><span class="n">bookId</span><span class="p">]</span>
            <span class="n">books</span> <span class="p">-=</span> <span class="n">bookId</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">book</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span>
                <span class="n">ok</span><span class="p">(</span><span class="s">&quot;Book with id &#39;$bookId&#39; deleted&quot;</span><span class="p">)</span>
            <span class="k">else</span>
                <span class="n">send</span><span class="p">(</span><span class="m">404</span><span class="p">,</span> <span class="s">&quot;Book not found&quot;</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="c1">// Matches path&#39;s requests with *any* HTTP method as a fallback (return 404 instead 405)</span>
        <span class="n">any</span><span class="p">(</span><span class="s">&quot;/books/{id}&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">send</span><span class="p">(</span><span class="m">405</span><span class="p">)</span> <span class="p">}</span>

        <span class="k">get</span><span class="p">(</span><span class="s">&quot;/books&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">ok</span><span class="p">(</span><span class="n">books</span><span class="p">.</span><span class="n">keys</span><span class="p">.</span><span class="n">joinToString</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">,</span> <span class="n">transform</span> <span class="p">=</span> <span class="n">Int</span><span class="o">::</span><span class="n">toString</span><span class="p">))</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h2 id="session-example">Session Example<a class="headerlink" href="#session-example" title="Permanent link">&para;</a></h2>
<p>Example showing how to use sessions. Here you can check the
<a href="https://github.com/hexagonkt/hexagon/blob/master/port_http_server/src/test/kotlin/com/hexagonkt/http/server/examples/SessionTest.kt">full test</a>.</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="py">server</span><span class="p">:</span> <span class="n">Server</span> <span class="k">by</span> <span class="n">lazy</span> <span class="p">{</span>
    <span class="n">Server</span><span class="p">(</span><span class="n">adapter</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">path</span><span class="p">(</span><span class="s">&quot;/session&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">get</span><span class="p">(</span><span class="s">&quot;/id&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">ok</span><span class="p">(</span><span class="n">session</span><span class="p">.</span><span class="n">id</span> <span class="o">?:</span> <span class="s">&quot;null&quot;</span><span class="p">)</span> <span class="p">}</span>
            <span class="k">get</span><span class="p">(</span><span class="s">&quot;/access&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">ok</span><span class="p">(</span><span class="n">session</span><span class="p">.</span><span class="n">lastAccessedTime</span><span class="o">?.</span><span class="n">toString</span><span class="p">()</span> <span class="o">?:</span> <span class="s">&quot;null&quot;</span><span class="p">)</span> <span class="p">}</span>
            <span class="k">get</span><span class="p">(</span><span class="s">&quot;/new&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">ok</span><span class="p">(</span><span class="n">session</span><span class="p">.</span><span class="n">isNew</span><span class="p">())</span> <span class="p">}</span>

            <span class="n">path</span><span class="p">(</span><span class="s">&quot;/inactive&quot;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">get</span> <span class="p">{</span> <span class="n">ok</span><span class="p">(</span><span class="n">session</span><span class="p">.</span><span class="n">maxInactiveInterval</span> <span class="o">?:</span> <span class="s">&quot;null&quot;</span><span class="p">)</span> <span class="p">}</span>
                <span class="n">put</span><span class="p">(</span><span class="s">&quot;/{time}&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">session</span><span class="p">.</span><span class="n">maxInactiveInterval</span> <span class="p">=</span> <span class="n">pathParameters</span><span class="p">[</span><span class="s">&quot;time&quot;</span><span class="p">].</span><span class="n">toInt</span><span class="p">()</span> <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">get</span><span class="p">(</span><span class="s">&quot;/creation&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">ok</span><span class="p">(</span><span class="n">session</span><span class="p">.</span><span class="n">creationTime</span> <span class="o">?:</span> <span class="s">&quot;null&quot;</span><span class="p">)</span> <span class="p">}</span>
            <span class="n">post</span><span class="p">(</span><span class="s">&quot;/invalidate&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">session</span><span class="p">.</span><span class="n">invalidate</span><span class="p">()</span> <span class="p">}</span>

            <span class="n">path</span><span class="p">(</span><span class="s">&quot;/{key}&quot;</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">put</span><span class="p">(</span><span class="s">&quot;/{value}&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">session</span><span class="p">.</span><span class="k">set</span><span class="p">(</span><span class="n">pathParameters</span><span class="p">[</span><span class="s">&quot;key&quot;</span><span class="p">],</span> <span class="n">pathParameters</span><span class="p">[</span><span class="s">&quot;value&quot;</span><span class="p">])</span> <span class="p">}</span>
                <span class="k">get</span> <span class="p">{</span> <span class="n">ok</span><span class="p">(</span><span class="n">session</span><span class="p">.</span><span class="k">get</span><span class="p">(</span><span class="n">pathParameters</span><span class="p">[</span><span class="s">&quot;key&quot;</span><span class="p">]).</span><span class="n">toString</span><span class="p">())</span> <span class="p">}</span>
                <span class="n">delete</span> <span class="p">{</span> <span class="n">session</span><span class="p">.</span><span class="n">remove</span><span class="p">(</span><span class="n">pathParameters</span><span class="p">[</span><span class="s">&quot;key&quot;</span><span class="p">])</span> <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">get</span> <span class="p">{</span>
                <span class="k">val</span> <span class="py">attributes</span> <span class="p">=</span> <span class="n">session</span><span class="p">.</span><span class="n">attributes</span>
                <span class="k">val</span> <span class="py">attributeTexts</span> <span class="p">=</span> <span class="n">attributes</span><span class="p">.</span><span class="n">entries</span><span class="p">.</span><span class="n">map</span> <span class="p">{</span> <span class="n">it</span><span class="p">.</span><span class="n">key</span> <span class="p">+</span> <span class="s">&quot; : &quot;</span> <span class="p">+</span> <span class="n">it</span><span class="p">.</span><span class="n">value</span> <span class="p">}</span>

                <span class="n">response</span><span class="p">.</span><span class="n">setHeader</span><span class="p">(</span><span class="s">&quot;attributes&quot;</span><span class="p">,</span> <span class="n">attributeTexts</span><span class="p">.</span><span class="n">joinToString</span><span class="p">(</span><span class="s">&quot;, &quot;</span><span class="p">))</span>
                <span class="n">response</span><span class="p">.</span><span class="n">setHeader</span><span class="p">(</span><span class="s">&quot;attribute values&quot;</span><span class="p">,</span> <span class="n">attributes</span><span class="p">.</span><span class="n">values</span><span class="p">.</span><span class="n">joinToString</span><span class="p">(</span><span class="s">&quot;, &quot;</span><span class="p">))</span>
                <span class="n">response</span><span class="p">.</span><span class="n">setHeader</span><span class="p">(</span><span class="s">&quot;attribute names&quot;</span><span class="p">,</span> <span class="n">attributes</span><span class="p">.</span><span class="n">keys</span><span class="p">.</span><span class="n">joinToString</span><span class="p">(</span><span class="s">&quot;, &quot;</span><span class="p">))</span>

                <span class="n">response</span><span class="p">.</span><span class="n">setHeader</span><span class="p">(</span><span class="s">&quot;creation&quot;</span><span class="p">,</span> <span class="n">session</span><span class="p">.</span><span class="n">creationTime</span><span class="p">.</span><span class="n">toString</span><span class="p">())</span>
                <span class="n">response</span><span class="p">.</span><span class="n">setHeader</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="n">session</span><span class="p">.</span><span class="n">id</span> <span class="o">?:</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
                <span class="n">response</span><span class="p">.</span><span class="n">setHeader</span><span class="p">(</span><span class="s">&quot;last access&quot;</span><span class="p">,</span> <span class="n">session</span><span class="p">.</span><span class="n">lastAccessedTime</span><span class="p">.</span><span class="n">toString</span><span class="p">())</span>

                <span class="n">response</span><span class="p">.</span><span class="n">status</span> <span class="p">=</span> <span class="m">200</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h2 id="cookies-example">Cookies Example<a class="headerlink" href="#cookies-example" title="Permanent link">&para;</a></h2>
<p>Demo server to show the use of cookies. Here you can check the
<a href="https://github.com/hexagonkt/hexagon/blob/master/port_http_server/src/test/kotlin/com/hexagonkt/http/server/examples/CookiesTest.kt">full test</a>.</p>
<div class="codehilite"><pre><span></span><span class="k">val</span> <span class="py">server</span><span class="p">:</span> <span class="n">Server</span> <span class="k">by</span> <span class="n">lazy</span> <span class="p">{</span>
    <span class="n">Server</span><span class="p">(</span><span class="n">adapter</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">post</span><span class="p">(</span><span class="s">&quot;/assertNoCookies&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(!</span><span class="n">request</span><span class="p">.</span><span class="n">cookies</span><span class="p">.</span><span class="n">isEmpty</span><span class="p">())</span>
                <span class="n">halt</span><span class="p">(</span><span class="m">500</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="n">post</span><span class="p">(</span><span class="s">&quot;/addCookie&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">val</span> <span class="py">name</span> <span class="p">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s">&quot;cookieName&quot;</span><span class="p">]</span><span class="o">?.</span><span class="n">first</span><span class="p">()</span>
            <span class="k">val</span> <span class="py">value</span> <span class="p">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s">&quot;cookieValue&quot;</span><span class="p">]</span><span class="o">?.</span><span class="n">first</span><span class="p">()</span>
            <span class="n">response</span><span class="p">.</span><span class="n">addCookie</span><span class="p">(</span><span class="n">HttpCookie</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        <span class="p">}</span>

        <span class="n">post</span><span class="p">(</span><span class="s">&quot;/assertHasCookie&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">val</span> <span class="py">cookieName</span> <span class="p">=</span> <span class="n">parameters</span><span class="p">.</span><span class="n">require</span><span class="p">(</span><span class="s">&quot;cookieName&quot;</span><span class="p">).</span><span class="n">first</span><span class="p">()</span>
            <span class="k">val</span> <span class="py">cookieValue</span> <span class="p">=</span> <span class="n">request</span><span class="p">.</span><span class="n">cookies</span><span class="p">[</span><span class="n">cookieName</span><span class="p">]</span><span class="o">?.</span><span class="n">value</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">parameters</span><span class="p">[</span><span class="s">&quot;cookieValue&quot;</span><span class="p">]</span><span class="o">?.</span><span class="n">first</span><span class="p">()</span> <span class="p">!=</span> <span class="n">cookieValue</span><span class="p">)</span>
                <span class="n">halt</span><span class="p">(</span><span class="m">500</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="n">post</span><span class="p">(</span><span class="s">&quot;/removeCookie&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">response</span><span class="p">.</span><span class="n">removeCookie</span><span class="p">(</span><span class="n">parameters</span><span class="p">.</span><span class="n">require</span><span class="p">(</span><span class="s">&quot;cookieName&quot;</span><span class="p">).</span><span class="n">first</span><span class="p">())</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h2 id="error-handling-example">Error Handling Example<a class="headerlink" href="#error-handling-example" title="Permanent link">&para;</a></h2>
<p>Code to show how to handle callback exceptions and HTTP error codes. Here you can check the
<a href="https://github.com/hexagonkt/hexagon/blob/master/port_http_server/src/test/kotlin/com/hexagonkt/http/server/examples/ErrorsTest.kt">full test</a>.</p>
<div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">CustomException</span> <span class="p">:</span> <span class="n">IllegalArgumentException</span><span class="p">()</span>

<span class="k">val</span> <span class="py">server</span><span class="p">:</span> <span class="n">Server</span> <span class="k">by</span> <span class="n">lazy</span> <span class="p">{</span>
    <span class="n">Server</span><span class="p">(</span><span class="n">adapter</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">error</span><span class="p">(</span><span class="n">UnsupportedOperationException</span><span class="o">::</span><span class="k">class</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">response</span><span class="p">.</span><span class="n">setHeader</span><span class="p">(</span><span class="s">&quot;error&quot;</span><span class="p">,</span> <span class="n">it</span><span class="p">.</span><span class="n">message</span> <span class="o">?:</span> <span class="n">it</span><span class="p">.</span><span class="n">javaClass</span><span class="p">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">send</span><span class="p">(</span><span class="m">599</span><span class="p">,</span> <span class="s">&quot;Unsupported&quot;</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="n">error</span><span class="p">(</span><span class="n">IllegalArgumentException</span><span class="o">::</span><span class="k">class</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">response</span><span class="p">.</span><span class="n">setHeader</span><span class="p">(</span><span class="s">&quot;runtimeError&quot;</span><span class="p">,</span> <span class="n">it</span><span class="p">.</span><span class="n">message</span> <span class="o">?:</span> <span class="n">it</span><span class="p">.</span><span class="n">javaClass</span><span class="p">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">send</span><span class="p">(</span><span class="m">598</span><span class="p">,</span> <span class="s">&quot;Runtime&quot;</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="c1">// Catching `Exception` handles any unhandled exception before (it has to be the last)</span>
        <span class="n">error</span><span class="p">(</span><span class="n">Exception</span><span class="o">::</span><span class="k">class</span><span class="p">)</span> <span class="p">{</span> <span class="n">send</span><span class="p">(</span><span class="m">500</span><span class="p">,</span> <span class="s">&quot;Root handler&quot;</span><span class="p">)</span> <span class="p">}</span>

        <span class="c1">// It is possible to execute a handler upon a given status code before returning</span>
        <span class="n">error</span><span class="p">(</span><span class="m">588</span><span class="p">)</span> <span class="p">{</span> <span class="n">send</span><span class="p">(</span><span class="m">578</span><span class="p">,</span> <span class="s">&quot;588 -&gt; 578&quot;</span><span class="p">)</span> <span class="p">}</span>

        <span class="k">get</span><span class="p">(</span><span class="s">&quot;/exception&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="k">throw</span> <span class="n">UnsupportedOperationException</span><span class="p">(</span><span class="s">&quot;error message&quot;</span><span class="p">)</span> <span class="p">}</span>
        <span class="k">get</span><span class="p">(</span><span class="s">&quot;/baseException&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="k">throw</span> <span class="n">CustomException</span><span class="p">()</span> <span class="p">}</span>
        <span class="k">get</span><span class="p">(</span><span class="s">&quot;/unhandledException&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">error</span><span class="p">(</span><span class="s">&quot;error message&quot;</span><span class="p">)</span> <span class="p">}</span>

        <span class="k">get</span><span class="p">(</span><span class="s">&quot;/halt&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">halt</span><span class="p">(</span><span class="s">&quot;halted&quot;</span><span class="p">)</span> <span class="p">}</span>
        <span class="k">get</span><span class="p">(</span><span class="s">&quot;/588&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">halt</span><span class="p">(</span><span class="m">588</span><span class="p">)</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h2 id="filters-example">Filters Example<a class="headerlink" href="#filters-example" title="Permanent link">&para;</a></h2>
<p>This example shows how to add filters before and after route execution. Here you can check the
<a href="https://github.com/hexagonkt/hexagon/blob/master/port_http_server/src/test/kotlin/com/hexagonkt/http/server/examples/FiltersTest.kt">full test</a>.</p>
<div class="codehilite"><pre><span></span><span class="k">private</span> <span class="k">val</span> <span class="py">users</span><span class="p">:</span> <span class="n">Map</span><span class="p">&lt;</span><span class="n">String</span><span class="p">,</span> <span class="n">String</span><span class="p">&gt;</span> <span class="p">=</span> <span class="n">mapOf</span><span class="p">(</span>
    <span class="s">&quot;Turing&quot;</span> <span class="n">to</span> <span class="s">&quot;London&quot;</span><span class="p">,</span>
    <span class="s">&quot;Dijkstra&quot;</span> <span class="n">to</span> <span class="s">&quot;Rotterdam&quot;</span>
<span class="p">)</span>

<span class="k">private</span> <span class="k">val</span> <span class="py">server</span><span class="p">:</span> <span class="n">Server</span> <span class="k">by</span> <span class="n">lazy</span> <span class="p">{</span>
    <span class="n">Server</span><span class="p">(</span><span class="n">adapter</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">before</span> <span class="p">{</span> <span class="n">attributes</span><span class="p">[</span><span class="s">&quot;start&quot;</span><span class="p">]</span> <span class="p">=</span> <span class="n">nanoTime</span><span class="p">()</span> <span class="p">}</span>

        <span class="n">before</span><span class="p">(</span><span class="s">&quot;/protected/*&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">val</span> <span class="py">authorization</span> <span class="p">=</span> <span class="n">request</span><span class="p">.</span><span class="n">headers</span><span class="p">[</span><span class="s">&quot;Authorization&quot;</span><span class="p">]</span> <span class="o">?:</span> <span class="n">halt</span><span class="p">(</span><span class="m">401</span><span class="p">,</span> <span class="s">&quot;Unauthorized&quot;</span><span class="p">)</span>
            <span class="k">val</span> <span class="py">credentials</span> <span class="p">=</span> <span class="n">authorization</span><span class="p">.</span><span class="n">first</span><span class="p">().</span><span class="n">removePrefix</span><span class="p">(</span><span class="s">&quot;Basic &quot;</span><span class="p">)</span>
            <span class="k">val</span> <span class="py">userPassword</span> <span class="p">=</span> <span class="n">String</span><span class="p">(</span><span class="n">Base64</span><span class="p">.</span><span class="n">getDecoder</span><span class="p">().</span><span class="n">decode</span><span class="p">(</span><span class="n">credentials</span><span class="p">)).</span><span class="n">split</span><span class="p">(</span><span class="s">&quot;:&quot;</span><span class="p">)</span>

            <span class="c1">// Parameters set in call attributes are accessible in other filters and routes</span>
            <span class="n">attributes</span><span class="p">[</span><span class="s">&quot;username&quot;</span><span class="p">]</span> <span class="p">=</span> <span class="n">userPassword</span><span class="p">[</span><span class="m">0</span><span class="p">]</span>
            <span class="n">attributes</span><span class="p">[</span><span class="s">&quot;password&quot;</span><span class="p">]</span> <span class="p">=</span> <span class="n">userPassword</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>
        <span class="p">}</span>

        <span class="c1">// All matching filters are run in order unless call is halted</span>
        <span class="n">before</span><span class="p">(</span><span class="s">&quot;/protected/*&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">users</span><span class="p">[</span><span class="n">attributes</span><span class="p">[</span><span class="s">&quot;username&quot;</span><span class="p">]]</span> <span class="p">!=</span> <span class="n">attributes</span><span class="p">[</span><span class="s">&quot;password&quot;</span><span class="p">])</span>
                <span class="n">halt</span><span class="p">(</span><span class="m">403</span><span class="p">,</span> <span class="s">&quot;Forbidden&quot;</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="k">get</span><span class="p">(</span><span class="s">&quot;/protected/hi&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">ok</span><span class="p">(</span><span class="s">&quot;Hello ${attributes[&quot;</span><span class="n">username</span><span class="s">&quot;]}!&quot;</span><span class="p">)</span> <span class="p">}</span>

        <span class="c1">// After filters are ran even if request was halted before</span>
        <span class="n">after</span> <span class="p">{</span> <span class="n">response</span><span class="p">.</span><span class="n">setHeader</span><span class="p">(</span><span class="s">&quot;time&quot;</span><span class="p">,</span> <span class="n">nanoTime</span><span class="p">()</span> <span class="p">-</span> <span class="n">attributes</span><span class="p">[</span><span class="s">&quot;start&quot;</span><span class="p">]</span> <span class="k">as</span> <span class="n">Long</span><span class="p">)</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h2 id="files-example">Files Example<a class="headerlink" href="#files-example" title="Permanent link">&para;</a></h2>
<p>The following code shows how to serve resources and receive files. Here you can check the
<a href="https://github.com/hexagonkt/hexagon/blob/master/port_http_server/src/test/kotlin/com/hexagonkt/http/server/examples/FilesTest.kt">full test</a>.</p>
<div class="codehilite"><pre><span></span><span class="k">private</span> <span class="k">val</span> <span class="py">server</span><span class="p">:</span> <span class="n">Server</span> <span class="k">by</span> <span class="n">lazy</span> <span class="p">{</span>
    <span class="n">Server</span><span class="p">(</span><span class="n">adapter</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">assets</span><span class="p">(</span><span class="s">&quot;assets&quot;</span><span class="p">,</span> <span class="s">&quot;/html/*&quot;</span><span class="p">)</span> <span class="c1">// Serves `assets` resources on `/html/*`</span>
        <span class="n">assets</span><span class="p">(</span><span class="s">&quot;public&quot;</span><span class="p">)</span> <span class="c1">// Serves `public` resources folder on `/*`</span>
        <span class="n">post</span><span class="p">(</span><span class="s">&quot;/multipart&quot;</span><span class="p">)</span> <span class="p">{</span> <span class="n">ok</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">parts</span><span class="p">.</span><span class="n">keys</span><span class="p">.</span><span class="n">joinToString</span><span class="p">(</span><span class="s">&quot;:&quot;</span><span class="p">))</span> <span class="p">}</span>
        <span class="n">post</span><span class="p">(</span><span class="s">&quot;/file&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">val</span> <span class="py">part</span> <span class="p">=</span> <span class="n">request</span><span class="p">.</span><span class="n">parts</span><span class="p">.</span><span class="n">values</span><span class="p">.</span><span class="n">first</span><span class="p">()</span>
            <span class="k">val</span> <span class="py">content</span> <span class="p">=</span> <span class="n">part</span><span class="p">.</span><span class="n">inputStream</span><span class="p">.</span><span class="n">reader</span><span class="p">().</span><span class="n">readText</span><span class="p">()</span>
            <span class="n">ok</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
                
                  
                
              
              
                


  <h2 id="__comments">Comments</h2>
  <div id="disqus_thread"></div>
  <script>
    var disqus_config = function () {
      this.page.url = "https://hexagonkt.com/quick_start/";
      this.page.identifier =
        "/quick_start/";
    };
    (function() {
      var d = document, s = d.createElement("script");
      s.src = "//hexagonkt-com.disqus.com/embed.js";
      s.setAttribute("data-timestamp", +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>

              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a
            href=".."
            title="Home"
            class="md-flex md-footer-nav__link md-footer-nav__link--prev"
            rel="prev">

            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </span>
            </div>
          </a>
        
        
          <a
            href="../documentation/"
            title="Documentation"
            class="md-flex md-footer-nav__link md-footer-nav__link--next"
            rel="next">

            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Documentation
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Made with <i class="fa fa-heart"></i> by <a href="https://github.com/hexagonkt/hexagon/graphs/contributors">OSS contributors</a>. Licensed under <a href="https://github.com/hexagonkt/hexagon/blob/master/license.md">MIT License</a>

          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and <a href="https://squidfunk.github.io/mkdocs-material/"> Material for MkDocs</a>
        <div class="social-buttons">
          <a
            class="github-button"
            href="https://github.com/hexagonkt/hexagon/"
            data-icon="octicon-star"
            data-show-count="true"
            aria-label="Star hexagonkt/hexagon on GitHub">Star</a>
          <a
            class="github-button"
            href="https://github.com/hexagonkt/hexagon/subscription"
            data-icon="octicon-eye"
            data-show-count="true"
            aria-label="Watch hexagonkt/hexagon on GitHub">Watch</a>
          <a
            class="github-button"
            href="https://github.com/hexagonkt/hexagon/fork"
            data-icon="octicon-git-branch"
            data-show-count="true"
            aria-label="Fork hexagonkt/hexagon on GitHub">Fork</a>
          <a
            class="twitter-share-button"
            href="https://twitter.com/share?text=Hexagon Kotlin library">Tweet</a>
        </div>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://github.com/hexagonkt/hexagon" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/hexagon_kt" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://kotlinlang.slack.com/messages/hexagon" class="md-footer-social__link fa fa-slack"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.267712eb.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="https://buttons.github.io/buttons.js"></script>
      
        <script src="https://platform.twitter.com/widgets.js"></script>
      
    
  </body>
</html>